!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("tags-view",[],t):"object"==typeof exports?exports["tags-view"]=t():e["tags-view"]=t()}(window,(function(){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=28)}({0:function(e,t,a){"use strict";function n(e,t,a,n,s,o,i,r){var u,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),n&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),i?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=u):s&&(u=r?function(){s.call(this,this.$root.$options.shadowRoot)}:s),u)if(c.functional){c._injectStyles=u;var l=c.render;c.render=function(e,t){return u.call(t),l(e,t)}}else{var g=c.beforeCreate;c.beforeCreate=g?[].concat(g,u):[u]}return{exports:e,options:c}}a.d(t,"a",(function(){return n}))},1:function(e,t){e.exports=require("vuex")},28:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ul",{ref:"elTabs",class:{"ht-tags-container":!0,"full-container":e.moreTags.length}},[e._l(e.showTags,(function(t){return a("li",{key:t.name,class:{tag:!0,active:e.routeName===t.name},style:{minWidth:e.tagWidth+"px"}},[a("span",{staticClass:"tag-link",on:{click:function(a){return e.routeChange(t)}}},[e._v(e._s(t.meta&&(t.meta.tagName||t.meta.title)||t.name)+" ")]),e.viewTags.includes(t)?a("span",{staticClass:"tag-icon",on:{click:function(a){return a.stopPropagation(),e.closeTag(t.name)}}},[a("i",{staticClass:"el-icon-close"})]):e._e()])})),a("li",{staticClass:"tag dropdown-tag"},[a("el-dropdown",{attrs:{size:"small"}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-caret-bottom"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e._l(e.tagsMenus,(function(t){return a("el-dropdown-item",{key:t.command,staticClass:"ht-tag-dropdown-menu",attrs:{command:t}},[a("span",{staticClass:"tag-link",on:{click:function(a){return e.handleMenuClick(t)}}},[e._v(e._s(t.name))])])})),e.moreTags.length?a("el-dropdown-item",{attrs:{divided:""}}):e._e(),e._l([].concat(e.moreTags),(function(t){return a("el-dropdown-item",{key:t.name,staticClass:"ht-tag-dropdown-menu",attrs:{command:t}},[a("span",{staticClass:"tag-link",on:{click:function(a){return e.routeChange(t)}}},[e._v(e._s(t.meta&&(t.meta.tagName||t.meta.title)||t.name))]),a("span",{staticClass:"tag-icon",on:{click:function(a){return a.stopPropagation(),e.closeTag(t.name)}}},[a("i",{staticClass:"el-icon-close"})])])}))],2)],1)],1)],2)])};n._withStripped=!0;var s=a(5),o=a.n(s),i=a(4),r=a.n(i),u=a(1),c=a.n(u);let l,g;o.a.use(c.a);const d={async addTag({state:e,commit:t},a){if(g.find(e=>e.name===a.name))return;let n=[...e.viewTags,...e.moreTags];const s=n.findIndex(e=>e.name===a.name);s>=0?e.maxLength<s+1+g.length?(n.splice(s,1),n.unshift(a)):n.splice(s,1,a):n.unshift(a),await t("updateTags",n)},async closeTag({state:e,commit:t},a){let n=[...e.viewTags,...e.moreTags];const{currentRoute:s}=l;if(n=n.filter(e=>e.name!==a),s.name===a)if(n.length){const e=n[0];l.push({path:e.path,query:{...e.query}})}else l.push("/");await t("updateTags",n)},async closeTagByType({state:e,commit:t},a){let n=[...e.viewTags,...e.moreTags];switch(a.type){case"otherClose":n=n.filter(e=>e.name===a.name);break;case"allClose":n=[],l.push("/")}await t("updateTags",n)},async changeMaxTagsByWidth({state:e,commit:t},a){const n=Math.floor((a.width-30)/e.tagWidth),s=[...e.viewTags,...e.moreTags],o=s.findIndex(e=>e.name===a.routeName);o>=0&&n<o+1+g.length&&s.unshift(...s.splice(o,1)),e.maxLength=n,await t("updateTags",s)},async initTagsData({commit:e},t){l=t.router,g=t.defaultTags||[];let a=t.flexibleTags;a=a.filter(e=>{const t=l.match(e.path);return!g.map(e=>e.name).includes(e.name)&&t&&t.matched&&t.matched.length}),await e("updateTags",a)},async clearTags({state:e,commit:t}){e.viewTags=[],e.moreTags=[],await t("updateTags")}},m={updateTags(e,t){const a=t||[...e.viewTags,...e.moreTags];e.viewTags=a.splice(0,e.maxLength-g.length),e.moreTags=a}};var h=new c.a.Store({modules:{routeTags:{namespaced:!0,state:function(){return{tagWidth:140,maxLength:10,defaultTags:[],viewTags:[],moreTags:[]}},actions:d,mutations:m}}}),p={name:"HtTagsView",componentName:"HtTagsView",model:{prop:"value",event:"change"},props:{value:{type:Array,required:!0},defaultTags:{type:Array,default:()=>[]},menuList:{type:Array,required:!0}},store:h,data(){return{debounceChangeMaxTags:r()(100,this.changeMaxTags),curTab:null,tagsMenus:[{command:"otherClose",name:"关闭其它"},{command:"allClose",name:"关闭所有"}]}},computed:{...Object(u.mapState)("routeTags",["viewTags","moreTags","tagWidth"]),flexibleTags(){return[...this.viewTags,...this.moreTags]},showTags(){return[...this.defaultTags,...this.viewTags]||!1},routeName(){return this.$route.name},asideMenuActive(){return this.$route.meta&&this.$route.meta.selectedPath||this.$route.path},baseMenus(){const e=[];return function t(a){a.forEach(a=>{a.children?t(a.children):e.push(a)})}(this.menuList),e}},watch:{$route(){this.changeCurTag()},flexibleTags(e){this.$emit("change",e)}},created(){o.a.prototype.closePage=()=>{this.closeTag(this.$route.name)}},mounted(){this.initTagsData({defaultTags:this.defaultTags,router:this.$router,flexibleTags:this.value}),window.addEventListener("resize",this.debounceChangeMaxTags),"/"!==this.$route.fullPath&&this.changeCurTag(),this.$nextTick(()=>{this.changeMaxTags()})},beforeDestroy(){window.removeEventListener("resize",this.debounceChangeMaxTags)},methods:{...Object(u.mapActions)("routeTags",["addTag","closeTag","closeTagByType","changeMaxTagsByWidth","initTagsData"]),changeCurTag(){const e={name:this.$route.name,path:this.$route.path,query:this.$route.query||"",meta:this.$route.meta};this.addTag(e),this.$emit("cur-tag-change",e)},handleMenuClick(e){this.closeTagByType({type:e.command,name:this.routeName})},routeChange(e){this.$router.push({path:e.path,query:{...e.query}})},changeMaxTags(){this.$el&&this.changeMaxTagsByWidth({width:this.$el.offsetWidth,routeName:this.routeName})}}},f=a(0),T=Object(f.a)(p,n,[],!1,null,null,null);T.options.__file="packages/tags-view/src/tags-view.vue";var v=T.exports;v.install=function(e){e.component(v.name,v)};t.default=v},4:function(e,t){e.exports=require("throttle-debounce/debounce")},5:function(e,t){e.exports=require("vue")}}).default}));
//# sourceMappingURL=index.js.map