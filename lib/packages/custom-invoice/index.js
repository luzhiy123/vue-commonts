!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("hztl-ui/lib/utils/date-util"),require("hztl-ui/lib/packages/input"),require("hztl-ui/lib/packages/resize-box"),require("hztl-ui/lib/utils/priceUppercase")):"function"==typeof define&&define.amd?define("custom-invoice",["hztl-ui/lib/utils/date-util","hztl-ui/lib/packages/input","hztl-ui/lib/packages/resize-box","hztl-ui/lib/utils/priceUppercase"],t):"object"==typeof exports?exports["custom-invoice"]=t(require("hztl-ui/lib/utils/date-util"),require("hztl-ui/lib/packages/input"),require("hztl-ui/lib/packages/resize-box"),require("hztl-ui/lib/utils/priceUppercase")):e["custom-invoice"]=t(e["hztl-ui/lib/utils/date-util"],e["hztl-ui/lib/packages/input"],e["hztl-ui/lib/packages/resize-box"],e["hztl-ui/lib/utils/priceUppercase"])}(window,(function(e,t,a,i){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=21)}([function(e,t,a){"use strict";function i(e,t,a,i,s,n,o,l){var r,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),i&&(c.functional=!0),n&&(c._scopeId="data-v-"+n),o?(r=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=r):s&&(r=l?function(){s.call(this,this.$root.$options.shadowRoot)}:s),r)if(c.functional){c._injectStyles=r;var p=c.render;c.render=function(e,t){return r.call(t),p(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,r):[r]}return{exports:e,options:c}}a.d(t,"a",(function(){return i}))},function(e,t){e.exports=require("vuex")},function(e,t,a){"use strict";var i=a(4),s=a(1),n={props:{showSample:Boolean},data:()=>({curDate:new Date}),computed:{...Object(s.mapState)(["invoice","typeEmun","headerData"])},render(){const e=arguments[0];return e("div",{class:"ht-invoice-page-header"},[this.showSample?e("div",{class:"company-logo ht-invoice-sample-class"},["[公司徽章]"]):e("img",{class:"company-logo",attrs:{src:this.headerData.companyEmblem,alt:""}}),e("span",{class:"page-header-tip"},[e("span",{class:"title"},["打印时间："]),e("span",{class:`${this.showSample?"ht-invoice-sample-class":""}`},[Object(i.dateFormatFull)(this.curDate),"（",this.headerData.printCount,")"])]),e("div",{class:`page-header-title ${this.showSample?"ht-invoice-sample-class":""}`},[this.headerData.companyName,this.typeEmun[this.invoice.type]])])}},o=a(0),l=Object(o.a)(n,void 0,void 0,!1,null,null,null);l.options.__file="packages/custom-invoice/src/components/invoice-page-header.vue";var r=l.exports;var c={render(){const e=arguments[0];return e("div",{class:"ht-invoice-page-footer"},[e("div",{class:"print-copy-right"},["思锐软件 （010）60219478/60219479"])])}},p=Object(o.a)(c,void 0,void 0,!1,null,null,null);p.options.__file="packages/custom-invoice/src/components/invoice-page-footer.vue";var d=p.exports,u=a(3),m=a.n(u),h=a(5),v=a.n(h),f={components:{Draggable:v.a},props:{list:{type:Array,required:!0}},render(){const e=arguments[0];return e("div",{class:"ht-alternative-files"},[e(v.a,m()([{class:"ht-invoice-draggable-group"},{attrs:this.$attrs},{},{on:this.listeners},{attrs:{list:this.list}}]),[this.$scopedSlots.default?this.$scopedSlots.default(this.list):this.list.map(t=>e("div",{class:"list-group-item"},[e("div",{class:"file-item file-name text-ellipsis"},[t.name,"："]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis"},["[",t.sampleData||t.name,"]"])]))])])}},b=Object(o.a)(f,void 0,void 0,!1,null,null,null);b.options.__file="packages/custom-invoice/src/components/alternative-files.vue";var g=b.exports,y={props:{templateData:{type:Array,required:!0}},computed:{...Object(s.mapState)(["headerData"])},methods:{handleTemplateChange(e){this.$emit("change",e)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-header"},[e(g,m()([{},{on:this.$listeners},{},{attrs:this.$attrs},{attrs:{group:"header",list:this.templateData},scopedSlots:{default:t=>t.length?t.map(t=>e("div",{class:`list-group-item item-flex-${t.width}`},[e("div",{class:"file-item file-name text-ellipsis"},[t.name,"："]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis"},["[",this.headerData[t.file],"]"])])):e("div",{class:"no-data"},["拖拽页头页尾部字段设置"])}}]))])}},x=Object(o.a)(y,void 0,void 0,!1,null,null,null);x.options.__file="packages/custom-invoice/src/components/invoice-edit-header.vue";var D=x.exports,w=a(6),S=a.n(w),_=a(11),j=a.n(_),O={props:{templateData:{type:Array,required:!0}},data(){return{debounceHandleTemplateChange:S()(100,this.handleTemplateChange)}},computed:{...Object(s.mapState)(["detailsData"]),detail(){return this.detailsData[0]?this.detailsData[0]:{}}},methods:{handleTemplateChange(e){this.$emit("change",e)},handleChangeWidth(e,t){t.width=e,this.debounceHandleTemplateChange(this.templateData)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-body"},[e(g,m()([{attrs:{group:"body",handle:".dragghandle",list:this.templateData}},{on:this.$listeners},{},{attrs:this.$attrs},{scopedSlots:{default:t=>t.length?t.map(t=>e(j.a,{attrs:{width:t.width},on:{"change-width":e=>this.handleChangeWidth(e,t)},class:"list-group-item",style:{width:`${t.width}px`}},[e("div",{class:"dragghandle"},[e("div",{class:"file-item file-name text-ellipsis",attrs:{title:t.name}},[t.name]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis",attrs:{title:this.detail[t.file]}},["[",this.detail[t.file],"]"])])])):e("div",{class:"no-data"},["拖拽标题列数据设置表格"])}}]))])}},k=Object(o.a)(O,void 0,void 0,!1,null,null,null);k.options.__file="packages/custom-invoice/src/components/invoice-edit-body.vue";var F=k.exports,B=a(12),H=a.n(B),$={props:{showSample:Boolean,templateData:{type:Array,required:!0}},computed:{...Object(s.mapState)(["headerData"]),formatTemplateData(){return this.templateData.map(e=>{const t={...e};if(this.showSample)t.formatter=e=>`[${e}]`;else switch(t.type){case"date":t.formatter=i.dateFormat;break;case"uppercase":t.formatter=H.a;break;case"areaNames":t.formatter=e=>e.join("");break;default:t.formatter=e=>e}return t})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-header"},[e("div",{class:"ht-invoice-draggable-group"},[this.formatTemplateData.map(t=>e("div",{class:`list-group-item item-flex-${t.width}`},[e("div",{class:"file-item file-name"},[t.name,"："]),e("div",{class:`file-item ${this.showSample?"ht-invoice-sample-class":""} text-ellipsis`},[t.formatter(this.headerData[t.file])])]))])])}},z=Object(o.a)($,void 0,void 0,!1,null,null,null);z.options.__file="packages/custom-invoice/src/components/invoice-tem-header.vue";var T=z.exports,q={props:{showSample:Boolean,templateData:{type:Array,required:!0}},computed:{...Object(s.mapState)(["detailsData"]),columns(){return this.templateData.map(e=>{let t;if(this.showSample)t=e=>`[${e}]`;else switch(e.type){case"index":t=(e,t,a)=>a+1;break;case"date":t=(e,t,a)=>a}return{...e,formatter:t}})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-body"},[e("el-table",{attrs:{data:this.detailsData,border:!0,"row-class-name":this.showSample?"ht-invoice-sample-class":"","tooltip-effect":"dark",size:"mini"}},[this.columns.map(t=>e("el-table-column",{key:t.key||t.prop,attrs:{label:t.name,prop:t.file,width:t.width,align:t.align,"show-overflow-tooltip":!0},scopedSlots:{default:({row:e,$index:a})=>t.formatter?t.formatter(e[t.file],e,a):e[t.file]}}))])])}},C=Object(o.a)(q,void 0,void 0,!1,null,null,null);C.options.__file="packages/custom-invoice/src/components/invoice-tem-body.vue";var E=C.exports;a.d(t,"a",(function(){return g})),a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return D})),a.d(t,"b",(function(){return F})),a.d(t,"g",(function(){return T})),a.d(t,"f",(function(){return E}))},function(e,t){e.exports=require("@vue/babel-helper-vue-jsx-merge-props")},function(t,a){t.exports=e},function(e,t){e.exports=require("vuedraggable")},function(e,t){e.exports=require("throttle-debounce/debounce")},,,function(e,a){e.exports=t},function(e,t){e.exports=require("vue")},function(e,t){e.exports=a},function(e,t){e.exports=i},function(e,t,a){"use strict";var i=a(10),s=a.n(i),n=a(1),o=a.n(n);const l={showSample:!0,typeEmun:{},invoice:{name:"",type:"",id:""},baseHeaders:[],baseBodys:[],templateHeader:[],templateBody:[],templateFooter:[],headerData:{},detailsData:[]};const r={async initStoreData({commit:e},t){const{typeEmun:a,baseFiles:i,temData:s,showSample:n,invoiceData:o}=t;await e("setShowSample",n),await e("setTypeEmun",a),await e("setBaseFiles",i),await e("setTemplateData",s),await e("initInvoiceData",o)}},c={altHeaderFiles:e=>e.baseHeaders.filter(t=>![...e.templateHeader,...e.templateFooter].find(e=>e.name===t.name)),altBodyFiles:e=>e.baseBodys.filter(t=>!e.templateBody.find(e=>e.name===t.name)).map(e=>({width:e.width||100,...e}))},p={setTypeEmun(e,t){e.typeEmun=t},setBaseFiles(e,t){t&&t.baseHeaders&&t.baseBodys?(e.baseHeaders=t.baseHeaders,e.baseBodys=t.baseBodys):(console.error("baseFiles 参数缺失",t),e.baseHeaders=[],e.baseBodys=[])},setTemplateData(e,t){e.invoice={name:t.name,type:t.type,id:t.id};const a={templateHeader:[],templateBody:[],templateFooter:[],...t.content?JSON.parse(t.content):{}};e.templateHeader=a.templateHeader.map(t=>e.baseHeaders.find(e=>e.name===t.name)||"").filter(e=>e),e.templateFooter=a.templateFooter.map(t=>e.baseHeaders.find(e=>e.name===t.name)||"").filter(e=>e),e.templateBody=a.templateBody.map(t=>{const a=e.baseBodys.find(e=>e.name===t.name);return a?{...a,width:t.width}:""}).filter(e=>e)},setShowSample(e,t=!0){e.showSample=t},initInvoiceData(e,t){if(e.showSample){const t={printCount:0,companyName:"[公司名称]"},a=[{}],i=a[0];e.baseBodys.forEach(e=>{e.file&&(i[e.file]=e.sampleData||e.name)}),e.baseHeaders.forEach(e=>{t[e.file]=e.sampleData||e.name}),e.headerData=t,e.detailsData=a}else t&&(e.headerData=t.header,e.detailsData=t.details)}},d={...p,changeInvoiceName(e,t){e.invoice.name=t},changeTemplateHeader(e,t){e.templateHeader=t},changeTemplateBody(e,t){e.templateBody=t},changeTemplateFooter(e,t){e.templateFooter=t}},u={...p},m={state:function(){return{type:"edit",...l}},actions:r,getters:c,mutations:d},h={state:function(){return{type:"tem",...l}},actions:r,getters:c,mutations:u};function v(){return new o.a.Store({...m})}function f(){return new o.a.Store({...h})}a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return f})),s.a.use(o.a)},,,,,,,,function(e,t,a){"use strict";a.r(t);var i=a(1),s=a(5),n=a.n(s),o=a(13),l=a(9),r=a.n(l),c=a(2),p={computed:{...Object(i.mapState)(["invoice"]),...Object(i.mapGetters)(["altHeaderFiles","altBodyFiles"]),disInvoiceName:{get(){return this.invoice.name},set(e){this.changeInvoiceName(e)}}},methods:{...Object(i.mapMutations)(["changeInvoiceName"])},render(){const e=arguments[0];return e("div",{class:"ht-invoice-alternative flex-container column-flex"},[e("div",{class:"page-container"},[e("div",{class:"page-title"},["模版名称"]),e(r.a,{class:"form-value",attrs:{size:"mini"},model:{value:this.disInvoiceName,callback:e=>{this.disInvoiceName=e}}})]),e("div",{class:"page-title"},[e("span",["打印内容"]),e("span",{class:"color-gray"},["（拖拽到画布中）"])]),e("div",{class:"ht-invoice-alternative-box auto-block flex-container column-flex"},[e("div",{class:"sub-title"},[" · 页头页尾独立字段"]),e(c.a,{attrs:{group:"header",list:this.altHeaderFiles},class:"auto-block"})]),e("div",{class:"ht-invoice-alternative-box auto-block flex-container column-flex"},[e("div",{class:"sub-title"},[" · 标题列数据"]),e(c.a,{class:"auto-block",attrs:{group:"body",list:this.altBodyFiles}})])])}},d=a(0),u=Object(d.a)(p,void 0,void 0,!1,null,null,null);u.options.__file="packages/custom-invoice/src/invoice-alternative.vue";var m=u.exports,h={components:{},computed:{...Object(i.mapState)(["invoice","templateHeader","templateBody","templateFooter"])},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-warp"},[e("div",{class:"ht-invoice-edit-box"},[e("div",{class:"ht-invoice-edit-content-box"},[e("div",{class:"ht-invoice-edit-content"},[e(c.e,{attrs:{showSample:!0}}),e(c.c,{attrs:{templateData:this.templateHeader}}),e(c.b,{attrs:{templateData:this.templateBody}}),e(c.c,{attrs:{templateData:this.templateFooter}}),e(c.d)])])])])}},v=Object(d.a)(h,void 0,void 0,!1,null,null,null);v.options.__file="packages/custom-invoice/src/invoice-edit-warp.vue";var f=v.exports,b={name:"HtCustomInvoice",componentName:"HtCustomInvoice",props:{typeEmun:Object,temData:{type:Object,required:!0},baseFiles:{type:Object,required:!0}},computed:{...Object(i.mapState)(["invoice","templateHeader","templateBody","templateFooter"])},watch:{baseFiles:{immediate:!0,handler(){this.$nextTick(()=>{this.initData()})}},temData(){this.setTemplateData(this.temData)}},beforeCreate(){this.$store=Object(o.a)()},methods:{...Object(i.mapActions)(["initStoreData"]),...Object(i.mapMutations)(["setTemplateData"]),initData(){this.initStoreData({typeEmun:this.typeEmun,baseFiles:this.baseFiles,temData:this.temData})},saveAll(){this.$emit("template-change",{...this.invoice,content:JSON.stringify({templateHeader:this.templateHeader.map(e=>({name:e.name})),templateBody:this.templateBody.map(e=>({name:e.name,width:e.width})),templateFooter:this.templateFooter.map(e=>({name:e.name}))})})}},render(){const e=arguments[0];return e(n.a,{class:"full-height full-width ht-trashzone",attrs:{group:{name:"trash",draggable:".dropitem",put:()=>!0,pull:!1},handle:".no-trash-handle"}},[e("div",{class:"flex-container ht-custom-invoice"},[e(m),e("div",{class:"flex-container column-flex invoice-warp-content"},[e("div",{class:"button-group"},[e("a",{class:"link",on:{click:this.initData}},[e("i",{class:"el-icon-refresh"}),"  还原"]),"  ",e("a",{class:"link",on:{click:this.saveAll}},[e("i",{class:"el-icon-document-checked"}),"  保存"])]),e(f,{class:"auto-block"})])])])}},g=Object(d.a)(b,void 0,void 0,!1,null,null,null);g.options.__file="packages/custom-invoice/src/custom-invoice.vue";var y=g.exports;y.install=function(e){e.component(y.name,y)};t.default=y}]).default}));
//# sourceMappingURL=index.js.map