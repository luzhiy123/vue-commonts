!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("hztl-ui/lib/utils/date-util"),require("hztl-ui/lib/packages/input"),require("hztl-ui/lib/packages/resize-box"),require("hztl-ui/lib/utils/priceUppercase")):"function"==typeof define&&define.amd?define("custom-invoice",["hztl-ui/lib/utils/date-util","hztl-ui/lib/packages/input","hztl-ui/lib/packages/resize-box","hztl-ui/lib/utils/priceUppercase"],t):"object"==typeof exports?exports["custom-invoice"]=t(require("hztl-ui/lib/utils/date-util"),require("hztl-ui/lib/packages/input"),require("hztl-ui/lib/packages/resize-box"),require("hztl-ui/lib/utils/priceUppercase")):e["custom-invoice"]=t(e["hztl-ui/lib/utils/date-util"],e["hztl-ui/lib/packages/input"],e["hztl-ui/lib/packages/resize-box"],e["hztl-ui/lib/utils/priceUppercase"])}(window,(function(e,t,a,i){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=26)}([function(e,t,a){"use strict";function i(e,t,a,i,s,o,n,r){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),i&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),n?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=l):s&&(l=r?function(){s.call(this,this.$root.$options.shadowRoot)}:s),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(e,t){return l.call(t),u(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}a.d(t,"a",(function(){return i}))},function(e,t){e.exports=require("vuex")},function(e,t,a){"use strict";var i=a(4),s=a(1),o={props:{showSample:Boolean},data:()=>({curDate:new Date}),computed:{...Object(s.mapState)(["invoice","typeEmun"]),...Object(s.mapGetters)(["headerData"])},render(){const e=arguments[0];return e("div",{class:"ht-invoice-page-header"},[this.showSample?e("div",{class:"company-logo ht-invoice-sample-class"},["[公司徽章]"]):e("img",{class:"company-logo",attrs:{src:this.headerData.companyEmblem,alt:""}}),e("span",{class:"page-header-tip"},[e("span",{class:"title"},["打印时间："]),e("span",{class:`${this.showSample?"ht-invoice-sample-class":""}`},[Object(i.dateFormatFull)(this.curDate),"（",this.headerData.printCount,")"])]),e("div",{class:`page-header-title ${this.showSample?"ht-invoice-sample-class":""}`},[this.headerData.companyName,this.typeEmun[this.invoice.type]])])}},n=a(0),r=Object(n.a)(o,void 0,void 0,!1,null,null,null);r.options.__file="packages/custom-invoice/src/components/invoice-page-header.vue";var l=r.exports,c=a(5),u={render(){const e=arguments[0];return e("div",{class:"ht-invoice-page-footer"},[e("div",{class:"print-copy-right"},[c.b])])}},d=Object(n.a)(u,void 0,void 0,!1,null,null,null);d.options.__file="packages/custom-invoice/src/components/invoice-page-footer.vue";var p=d.exports,m=a(3),h=a.n(m),v=a(6),f=a.n(v),b={components:{Draggable:f.a},props:{list:{type:Array,required:!0}},methods:{changeHandle(){this.$emit("change",this.list)}},render(){const e=arguments[0];return e("div",{class:"ht-alternative-files"},[e(f.a,h()([{class:"ht-invoice-draggable-group"},{attrs:this.$attrs},{on:{change:()=>this.changeHandle()},attrs:{list:this.list}}]),[this.$scopedSlots.default?this.$scopedSlots.default(this.list):this.list.map(t=>e("div",{class:"list-group-item"},[e("div",{class:"file-item file-name text-ellipsis"},[t.name,"："]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis"},["[",t.sampleData||t.name,"]"])]))])])}},g=Object(n.a)(b,void 0,void 0,!1,null,null,null);g.options.__file="packages/custom-invoice/src/components/alternative-files.vue";var y=g.exports,D={props:{templateData:{type:Array,required:!0}},data:()=>({useTemplateData:[]}),computed:{...Object(s.mapGetters)(["headerData"])},watch:{templateData:{immediate:!0,handler(e){this.useTemplateData=e}}},methods:{handleTemplateChange(e){this.$emit("change",e)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-header"},[e(y,h()([{},{on:this.$listeners},{},{attrs:this.$attrs},{attrs:{group:"header",list:this.useTemplateData},scopedSlots:{default:t=>t.length?t.map(t=>e("div",{class:`list-group-item item-flex-${t.width}`},[e("div",{class:"file-item file-name text-ellipsis"},[t.name,"："]),e("div",{class:`file-item ${"signature"===t.type?"signature-file":""} ht-invoice-sample-class text-ellipsis`},["signature"===t.type?"":`[${this.headerData[t.file]}]`])])):e("div",{class:"no-data"},["拖拽页头页尾部字段设置"])}}]))])}},S=Object(n.a)(D,void 0,void 0,!1,null,null,null);S.options.__file="packages/custom-invoice/src/components/invoice-edit-header.vue";var x=S.exports,w=a(7),F=a.n(w),_=a(12),j=a.n(_),B={props:{soureFile:{type:String,required:!0},templateData:{type:Array,required:!0}},data(){return{debounceHandleTemplateChange:F()(100,this.handleTemplateChange),useTemplateData:[]}},computed:{...Object(s.mapGetters)(["bodysData"]),detail(){return this.bodysData[this.soureFile][0]?this.bodysData[this.soureFile][0]:{}}},watch:{templateData:{immediate:!0,handler(e){this.useTemplateData=e}}},methods:{handleTemplateChange(e){this.$emit("change",e)},handleChangeWidth(e,t){t.width=e,this.debounceHandleTemplateChange(this.templateData)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-body"},[e(y,h()([{attrs:{group:`body${this.soureFile}`,handle:".dragghandle",list:this.useTemplateData}},{on:this.$listeners},{},{attrs:this.$attrs},{scopedSlots:{default:t=>t.length?t.map(t=>e(j.a,{attrs:{width:t.width},on:{"change-width":e=>this.handleChangeWidth(e,t)},class:"list-group-item",style:{width:`${t.width}px`}},[e("div",{class:"dragghandle"},[e("div",{class:"file-item file-name text-ellipsis",attrs:{title:t.name}},[t.name]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis",attrs:{title:this.detail[t.file]}},["[",this.detail[t.file],"]"])])])):e("div",{class:"no-data"},["拖拽标题列数据设置表格"])}}]))])}},O=Object(n.a)(B,void 0,void 0,!1,null,null,null);O.options.__file="packages/custom-invoice/src/components/invoice-edit-body.vue";var k=O.exports,T=a(13),$=a.n(T),H={props:{showSample:Boolean,templateData:{type:Array,required:!0}},computed:{...Object(s.mapGetters)(["headerData"]),formatTemplateData(){return this.templateData.map(e=>{const t={...e};if(this.showSample)"signature"===t.type?t.formatter=()=>"":t.formatter=e=>`[${e}]`;else switch(t.type){case"date":t.formatter=i.dateFormat;break;case"uppercase":t.formatter=$.a;break;case"areaNames":t.formatter=e=>e.join("");break;case"signature":t.formatter=()=>"";break;default:t.formatter=e=>e}return t})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-header"},[e("div",{class:"ht-invoice-draggable-group"},[this.formatTemplateData.map(t=>e("div",{class:`list-group-item item-flex-${t.width}`},[e("div",{class:"file-item file-name"},[t.name,"："]),e("div",{class:`file-item ${this.showSample?"ht-invoice-sample-class":""} ${"signature"===t.type?"signature-file":""} text-ellipsis`},[t.formatter(this.headerData[t.file])])]))])])}},C=Object(n.a)(H,void 0,void 0,!1,null,null,null);C.options.__file="packages/custom-invoice/src/components/invoice-tem-header.vue";var z=C.exports,q={props:{showSample:Boolean,templateData:{type:Array,required:!0},data:{type:Array,required:!0}},computed:{columns(){return this.templateData.map(e=>{let t;if(this.showSample)t=e=>`[${e}]`;else switch(e.type){case"index":t=(e,t,a)=>a+1;break;case"date":t=(e,t,a)=>a}return{...e,formatter:t}})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-body"},[e("el-table",{attrs:{data:this.data,border:!0,"row-class-name":this.showSample?"ht-invoice-sample-class":"","tooltip-effect":"dark",size:"mini"}},[this.columns.map(t=>e("el-table-column",{key:t.key||t.prop,attrs:{label:t.name,prop:t.file,width:t.width,align:t.align,"show-overflow-tooltip":!0},scopedSlots:{default:({row:e,$index:a})=>t.formatter?t.formatter(e[t.file],e,a):e[t.file]}}))])])}},E=Object(n.a)(q,void 0,void 0,!1,null,null,null);E.options.__file="packages/custom-invoice/src/components/invoice-tem-body.vue";var N=E.exports;a.d(t,"a",(function(){return y})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return x})),a.d(t,"b",(function(){return k})),a.d(t,"g",(function(){return z})),a.d(t,"f",(function(){return N}))},function(e,t){e.exports=require("@vue/babel-helper-vue-jsx-merge-props")},function(t,a){t.exports=e},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));const i="思锐软件 （010）60219478/60219479",s={1:"一",2:"二",3:"三"}},function(e,t){e.exports=require("vuedraggable")},function(e,t){e.exports=require("throttle-debounce/debounce")},,,function(e,a){e.exports=t},function(e,t){e.exports=require("vue")},function(e,t){e.exports=a},function(e,t){e.exports=i},function(e,t,a){"use strict";var i=a(11),s=a.n(i),o=a(1),n=a.n(o);const r={showSample:!0,typeEmun:{},invoice:{name:"",type:"",id:""},baseHeaders:[],baseBodys:[],temDataSource:{templateHeader:[],templateBody:[],templateFooter:[]},dataSource:{}};const l={async initStoreData({commit:e},t){const{typeEmun:a,baseFiles:i,temData:s,showSample:o,invoiceData:n}=t;await e("setShowSample",o),await e("setTypeEmun",a),await e("setBaseFiles",i),await e("setTemDataSource",s),await e("setDataSource",n)}},c={templateHeader:e=>e.temDataSource.templateHeader.map(t=>e.baseHeaders.find(e=>e.name===t.name)||null).filter(e=>e),templateFooter:e=>e.temDataSource.templateFooter.map(t=>e.baseHeaders.find(e=>e.name===t.name)||null).filter(e=>e),templateBody:e=>e.temDataSource.templateBody.map(t=>({...t,content:t.content.map(a=>{let i;return e.baseBodys.forEach(e=>{i||e.soureFile===t.soureFile&&e.content.forEach(e=>{e.name===a.name&&(i=e)})}),i?{...i,width:a.width||100}:null}).filter(e=>e)})),altHeaderFiles:(e,t)=>e.baseHeaders.filter(e=>![...t.templateHeader,...t.templateFooter].find(t=>t.name===e.name)),altBodyFiles:(e,t)=>e.baseBodys.map(e=>({...e,content:e.content.filter(a=>{const i=t.templateBody.find(t=>t.soureFile===e.soureFile);return i&&!i.content.find(e=>e.name===a.name)})})),headerData(e){if(e.showSample){const t={printCount:0,companyName:"[公司名称]"};return e.baseHeaders.forEach(e=>{t[e.file]=e.sampleData||e.name}),t}return e.dataSource.header},bodysData(e){if(e.showSample){let t={};return e.baseBodys.forEach(e=>{t[e.soureFile]=[{}],e.content.forEach(a=>{t[e.soureFile][0][a.file]=a.sampleData||a.name})}),t}return e.dataSource}},u={setTypeEmun(e,t){e.typeEmun=t},setBaseFiles(e,t){if(t&&t.baseHeaders&&t.baseBodys){e.baseHeaders=t.baseHeaders.map(e=>({...e,width:e.width||1}));const a=t.baseBodys&&t.baseBodys[0];a&&a.soureFile?e.baseBodys=t.baseBodys:e.baseBodys=[{tableName:"",soureFile:"details",content:t.baseBodys||[]}]}else console.error("baseFiles 参数缺失",t),e.baseHeaders=[],e.baseBodys=[{tableName:"",soureFile:"details",content:[]}]},setTemDataSource(e,t){e.invoice={name:t.name,type:t.type,id:t.id};const a=t.content?JSON.parse(t.content):{},i=a.templateBody&&a.templateBody[0];e.temDataSource={templateHeader:[],templateFooter:[],...a,templateBody:i&&i.soureFile?a.templateBody:e.baseBodys.map(e=>({...e,content:a.templateBody||[]}))}},setShowSample(e,t=!0){e.showSample=t},setDataSource(e,t){e.dataSource=t||{}}},d={...u,changeInvoiceName(e,t){e.invoice.name=t},changeTemplateHeader(e,t){e.temDataSource={...e.temDataSource,templateHeader:t}},changeTemplateBody(e,t){e.temDataSource.templateBody=t},changeTemplateFooter(e,t){e.temDataSource.templateFooter=t}},p={...u},m={state:function(){return{type:"edit",...r}},actions:l,getters:c,mutations:d},h={state:function(){return{type:"tem",...r}},actions:l,getters:c,mutations:p};function v(){return new n.a.Store({...m})}function f(){return new n.a.Store({...h})}a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return f})),s.a.use(n.a)},,,,,,,,,,,,function(e,t,a){"use strict";a.r(t);var i=a(1),s=a(6),o=a.n(s),n=a(14),r=a(10),l=a.n(r),c=a(2),u={computed:{...Object(i.mapState)(["invoice"]),...Object(i.mapGetters)(["altHeaderFiles","altBodyFiles"]),disInvoiceName:{get(){return this.invoice.name},set(e){this.changeInvoiceName(e.replace(/ /g,""))}}},methods:{...Object(i.mapMutations)(["changeInvoiceName"])},render(){const e=arguments[0];return e("div",{class:"ht-invoice-alternative flex-container column-flex"},[e("div",{class:"page-container"},[e("div",{class:"page-title"},["模版名称"]),e(l.a,{class:"form-value",attrs:{size:"mini"},model:{value:this.disInvoiceName,callback:e=>{this.disInvoiceName=e}}})]),e("div",{class:"page-title"},[e("span",["打印内容"]),e("span",{class:"color-gray"},["（拖拽到画布中）"])]),e("div",{class:"ht-invoice-alternative-box auto-block flex-container column-flex"},[e("div",{class:"sub-title"},[" · 页头页尾独立字段"]),e(c.a,{attrs:{group:"header",list:this.altHeaderFiles},class:"auto-block"})]),this.altBodyFiles.map(t=>e("div",{class:"ht-invoice-alternative-box auto-block flex-container column-flex"},[e("div",{class:"sub-title"},[" · ",t.tableName,"标题列数据"]),e(c.a,{class:"auto-block",attrs:{group:`body${t.soureFile}`,list:t.content}})]))])}},d=a(0),p=Object(d.a)(u,void 0,void 0,!1,null,null,null);p.options.__file="packages/custom-invoice/src/invoice-alternative.vue";var m=p.exports,h=a(5),v={data:()=>({isShowEditBody:!0}),computed:{...Object(i.mapState)(["invoice"]),...Object(i.mapGetters)(["templateHeader","templateBody","templateFooter","bodysData"])},methods:{...Object(i.mapMutations)(["changeTemplateHeader","changeTemplateFooter","changeTemplateBody"]),bodyChange(e,t){let a=[...this.templateBody];a.find(t=>t.soureFile===e).content=t,this.changeTemplateBody(a)},headerChange(e){this.changeTemplateHeader(e)},footerChange(e){this.changeTemplateFooter(e)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-warp"},[e("div",{class:"ht-invoice-edit-box"},[e("div",{class:"ht-invoice-edit-content-box"},[e("div",{class:"ht-invoice-edit-content"},[e(c.e,{attrs:{showSample:!0}}),e(c.c,{attrs:{templateData:this.templateHeader},on:{change:this.headerChange}}),e("div",{class:"ht-invoice-body-box"},[this.templateBody.map((t,a)=>this.bodysData[t.soureFile]&&e("div",{class:"ht-invoice-body-block"},[t.tableName&&e("div",{class:"ht-invoice-table-name"},[`${h.a[a+1]}、${t.tableName}`]),e(c.b,{attrs:{soureFile:t.soureFile,templateData:t.content},on:{change:e=>this.bodyChange(t.soureFile,e)}})]))]),e(c.c,{attrs:{templateData:this.templateFooter},on:{change:this.footerChange}}),e(c.d)])])])])}},f=Object(d.a)(v,void 0,void 0,!1,null,null,null);f.options.__file="packages/custom-invoice/src/invoice-edit-warp.vue";var b=f.exports,g={name:"HtCustomInvoice",componentName:"HtCustomInvoice",props:{typeEmun:Object,temData:{type:Object,required:!0},baseFiles:{type:Object,required:!0}},computed:{...Object(i.mapState)(["invoice"]),...Object(i.mapGetters)(["templateHeader","templateBody","templateFooter"])},watch:{baseFiles:{immediate:!0,handler(){this.$nextTick(()=>{this.initData()})}},temData(){this.setTemDataSource(this.temData)}},beforeCreate(){this.$store=Object(n.a)()},methods:{...Object(i.mapActions)(["initStoreData"]),...Object(i.mapMutations)(["setTemDataSource"]),initData(){this.initStoreData({typeEmun:this.typeEmun,baseFiles:this.baseFiles,temData:this.temData})},saveAll(){this.$emit("template-change",{...this.invoice,content:JSON.stringify({templateHeader:this.templateHeader.map(e=>({name:e.name})),templateBody:this.templateBody.map(e=>({...e,content:e.content.map(e=>({name:e.name,width:e.width}))})),templateFooter:this.templateFooter.map(e=>({name:e.name}))})})}},render(){const e=arguments[0];return e(o.a,{class:"full-height full-width ht-trashzone",attrs:{group:{name:"trash",draggable:".dropitem",put:()=>!0,pull:!1},handle:".no-trash-handle"}},[e("div",{class:"flex-container ht-custom-invoice"},[e(m),e("div",{class:"flex-container column-flex invoice-warp-content"},[e("div",{class:"button-group"},[e("a",{class:"link",on:{click:this.initData}},[e("i",{class:"el-icon-refresh"}),"  还原"]),"  ",e("a",{class:"link",on:{click:this.saveAll}},[e("i",{class:"el-icon-document-checked"}),"  保存"])]),e(b,{class:"auto-block"})])])])}},y=Object(d.a)(g,void 0,void 0,!1,null,null,null);y.options.__file="packages/custom-invoice/src/custom-invoice.vue";var D=y.exports;D.install=function(e){e.component(D.name,D)};t.default=D}]).default}));
//# sourceMappingURL=index.js.map