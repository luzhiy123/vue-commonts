!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("hztl-ui/lib/utils/date-util"),require("hztl-ui/lib/packages/resize-box"),require("hztl-ui/lib/utils/priceUppercase")):"function"==typeof define&&define.amd?define("tem-invoice",["hztl-ui/lib/utils/date-util","hztl-ui/lib/packages/resize-box","hztl-ui/lib/utils/priceUppercase"],t):"object"==typeof exports?exports["tem-invoice"]=t(require("hztl-ui/lib/utils/date-util"),require("hztl-ui/lib/packages/resize-box"),require("hztl-ui/lib/utils/priceUppercase")):e["tem-invoice"]=t(e["hztl-ui/lib/utils/date-util"],e["hztl-ui/lib/packages/resize-box"],e["hztl-ui/lib/utils/priceUppercase"])}(window,(function(e,t,a){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=23)}([function(e,t,a){"use strict";function i(e,t,a,i,s,n,o,r){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),i&&(c.functional=!0),n&&(c._scopeId="data-v-"+n),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=l):s&&(l=r?function(){s.call(this,this.$root.$options.shadowRoot)}:s),l)if(c.functional){c._injectStyles=l;var p=c.render;c.render=function(e,t){return l.call(t),p(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}a.d(t,"a",(function(){return i}))},function(e,t){e.exports=require("vuex")},function(e,t,a){"use strict";var i=a(4),s=a(1),n={props:{showSample:Boolean},data:()=>({curDate:new Date}),computed:{...Object(s.mapState)(["invoice","typeEmun","headerData"])},render(){const e=arguments[0];return e("div",{class:"ht-invoice-page-header"},[this.showSample?e("div",{class:"company-logo ht-invoice-sample-class"},["[公司徽章]"]):e("img",{class:"company-logo",attrs:{src:this.headerData.companyEmblem,alt:""}}),e("span",{class:"page-header-tip"},[e("span",{class:"title"},["打印时间："]),e("span",{class:`${this.showSample?"ht-invoice-sample-class":""}`},[Object(i.dateFormatFull)(this.curDate),"（",this.headerData.printCount,")"])]),e("div",{class:`page-header-title ${this.showSample?"ht-invoice-sample-class":""}`},[this.headerData.companyName,this.typeEmun[this.invoice.type]])])}},o=a(0),r=Object(o.a)(n,void 0,void 0,!1,null,null,null);r.options.__file="packages/custom-invoice/src/components/invoice-page-header.vue";var l=r.exports;var c={render(){const e=arguments[0];return e("div",{class:"ht-invoice-page-footer"},[e("div",{class:"print-copy-right"},["思锐软件 （010）60219478/60219479"])])}},p=Object(o.a)(c,void 0,void 0,!1,null,null,null);p.options.__file="packages/custom-invoice/src/components/invoice-page-footer.vue";var d=p.exports,m=a(3),u=a.n(m),h=a(5),f=a.n(h),v={components:{Draggable:f.a},props:{list:{type:Array,required:!0}},render(){const e=arguments[0];return e("div",{class:"ht-alternative-files"},[e(f.a,u()([{class:"ht-invoice-draggable-group"},{attrs:this.$attrs},{},{on:this.listeners},{attrs:{list:this.list}}]),[this.$scopedSlots.default?this.$scopedSlots.default(this.list):this.list.map(t=>e("div",{class:"list-group-item"},[e("div",{class:"file-item file-name text-ellipsis"},[t.name,"："]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis"},["[",t.sampleData||t.name,"]"])]))])])}},b=Object(o.a)(v,void 0,void 0,!1,null,null,null);b.options.__file="packages/custom-invoice/src/components/alternative-files.vue";var y=b.exports,g={props:{templateData:{type:Array,required:!0}},computed:{...Object(s.mapState)(["headerData"])},methods:{handleTemplateChange(e){this.$emit("change",e)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-header"},[e(y,u()([{},{on:this.$listeners},{},{attrs:this.$attrs},{attrs:{group:"header",list:this.templateData},scopedSlots:{default:t=>t.length?t.map(t=>e("div",{class:`list-group-item item-flex-${t.width}`},[e("div",{class:"file-item file-name text-ellipsis"},[t.name,"："]),e("div",{class:`file-item ${"signature"===t.type?"signature-file":""} ht-invoice-sample-class text-ellipsis`},["signature"===t.type?"":`[${this.headerData[t.file]}]`])])):e("div",{class:"no-data"},["拖拽页头页尾部字段设置"])}}]))])}},D=Object(o.a)(g,void 0,void 0,!1,null,null,null);D.options.__file="packages/custom-invoice/src/components/invoice-edit-header.vue";var w=D.exports,S=a(6),x=a.n(S),_=a(11),j=a.n(_),O={props:{templateData:{type:Array,required:!0}},data(){return{debounceHandleTemplateChange:x()(100,this.handleTemplateChange)}},computed:{...Object(s.mapState)(["detailsData"]),detail(){return this.detailsData[0]?this.detailsData[0]:{}}},methods:{handleTemplateChange(e){this.$emit("change",e)},handleChangeWidth(e,t){t.width=e,this.debounceHandleTemplateChange(this.templateData)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-body"},[e(y,u()([{attrs:{group:"body",handle:".dragghandle",list:this.templateData}},{on:this.$listeners},{},{attrs:this.$attrs},{scopedSlots:{default:t=>t.length?t.map(t=>e(j.a,{attrs:{width:t.width},on:{"change-width":e=>this.handleChangeWidth(e,t)},class:"list-group-item",style:{width:`${t.width}px`}},[e("div",{class:"dragghandle"},[e("div",{class:"file-item file-name text-ellipsis",attrs:{title:t.name}},[t.name]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis",attrs:{title:this.detail[t.file]}},["[",this.detail[t.file],"]"])])])):e("div",{class:"no-data"},["拖拽标题列数据设置表格"])}}]))])}},$=Object(o.a)(O,void 0,void 0,!1,null,null,null);$.options.__file="packages/custom-invoice/src/components/invoice-edit-body.vue";var T=$.exports,B=a(12),F=a.n(B),H={props:{showSample:Boolean,templateData:{type:Array,required:!0}},computed:{...Object(s.mapState)(["headerData"]),formatTemplateData(){return this.templateData.map(e=>{const t={...e};if(this.showSample)"signature"===t.type?t.formatter=()=>"":t.formatter=e=>`[${e}]`;else switch(t.type){case"date":t.formatter=i.dateFormat;break;case"uppercase":t.formatter=F.a;break;case"areaNames":t.formatter=e=>e.join("");break;case"signature":t.formatter=()=>"";break;default:t.formatter=e=>e}return t})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-header"},[e("div",{class:"ht-invoice-draggable-group"},[this.formatTemplateData.map(t=>e("div",{class:`list-group-item item-flex-${t.width}`},[e("div",{class:"file-item file-name"},[t.name,"："]),e("div",{class:`file-item ${this.showSample?"ht-invoice-sample-class":""} ${"signature"===t.type?"signature-file":""} text-ellipsis`},[t.formatter(this.headerData[t.file])])]))])])}},k=Object(o.a)(H,void 0,void 0,!1,null,null,null);k.options.__file="packages/custom-invoice/src/components/invoice-tem-header.vue";var E=k.exports,q={props:{showSample:Boolean,templateData:{type:Array,required:!0}},computed:{...Object(s.mapState)(["detailsData"]),columns(){return this.templateData.map(e=>{let t;if(this.showSample)t=e=>`[${e}]`;else switch(e.type){case"index":t=(e,t,a)=>a+1;break;case"date":t=(e,t,a)=>a}return{...e,formatter:t}})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-body"},[e("el-table",{attrs:{data:this.detailsData,border:!0,"row-class-name":this.showSample?"ht-invoice-sample-class":"","tooltip-effect":"dark",size:"mini"}},[this.columns.map(t=>e("el-table-column",{key:t.key||t.prop,attrs:{label:t.name,prop:t.file,width:t.width,align:t.align,"show-overflow-tooltip":!0},scopedSlots:{default:({row:e,$index:a})=>t.formatter?t.formatter(e[t.file],e,a):e[t.file]}}))])])}},z=Object(o.a)(q,void 0,void 0,!1,null,null,null);z.options.__file="packages/custom-invoice/src/components/invoice-tem-body.vue";var C=z.exports;a.d(t,"a",(function(){return y})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return w})),a.d(t,"b",(function(){return T})),a.d(t,"g",(function(){return E})),a.d(t,"f",(function(){return C}))},function(e,t){e.exports=require("@vue/babel-helper-vue-jsx-merge-props")},function(t,a){t.exports=e},function(e,t){e.exports=require("vuedraggable")},function(e,t){e.exports=require("throttle-debounce/debounce")},,,,function(e,t){e.exports=require("vue")},function(e,a){e.exports=t},function(e,t){e.exports=a},function(e,t,a){"use strict";var i=a(10),s=a.n(i),n=a(1),o=a.n(n);const r={showSample:!0,typeEmun:{},invoice:{name:"",type:"",id:""},baseHeaders:[],baseBodys:[],templateHeader:[],templateBody:[],templateFooter:[],headerData:{},detailsData:[]};const l={async initStoreData({commit:e},t){const{typeEmun:a,baseFiles:i,temData:s,showSample:n,invoiceData:o}=t;await e("setShowSample",n),await e("setTypeEmun",a),await e("setBaseFiles",i),await e("setTemplateData",s),await e("initInvoiceData",o)}},c={altHeaderFiles:e=>e.baseHeaders.filter(t=>![...e.templateHeader,...e.templateFooter].find(e=>e.name===t.name)),altBodyFiles:e=>e.baseBodys.filter(t=>!e.templateBody.find(e=>e.name===t.name)).map(e=>({width:e.width||100,...e}))},p={setTypeEmun(e,t){e.typeEmun=t},setBaseFiles(e,t){t&&t.baseHeaders&&t.baseBodys?(e.baseHeaders=t.baseHeaders,e.baseBodys=t.baseBodys):(console.error("baseFiles 参数缺失",t),e.baseHeaders=[],e.baseBodys=[])},setTemplateData(e,t){e.invoice={name:t.name,type:t.type,id:t.id};const a={templateHeader:[],templateBody:[],templateFooter:[],...t.content?JSON.parse(t.content):{}};e.templateHeader=a.templateHeader.map(t=>e.baseHeaders.find(e=>e.name===t.name)||"").filter(e=>e),e.templateFooter=a.templateFooter.map(t=>e.baseHeaders.find(e=>e.name===t.name)||"").filter(e=>e),e.templateBody=a.templateBody.map(t=>{const a=e.baseBodys.find(e=>e.name===t.name);return a?{...a,width:t.width}:""}).filter(e=>e)},setShowSample(e,t=!0){e.showSample=t},initInvoiceData(e,t){if(e.showSample){const t={printCount:0,companyName:"[公司名称]"},a=[{}],i=a[0];e.baseBodys.forEach(e=>{e.file&&(i[e.file]=e.sampleData||e.name)}),e.baseHeaders.forEach(e=>{t[e.file]=e.sampleData||e.name}),e.headerData=t,e.detailsData=a}else t&&(e.headerData=t.header,e.detailsData=t.details)}},d={...p,changeInvoiceName(e,t){e.invoice.name=t},changeTemplateHeader(e,t){e.templateHeader=t},changeTemplateBody(e,t){e.templateBody=t},changeTemplateFooter(e,t){e.templateFooter=t}},m={...p},u={state:function(){return{type:"edit",...r}},actions:l,getters:c,mutations:d},h={state:function(){return{type:"tem",...r}},actions:l,getters:c,mutations:m};function f(){return new o.a.Store({...u})}function v(){return new o.a.Store({...h})}a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return v})),s.a.use(o.a)},,,,,,,,,,function(e,t,a){"use strict";a.r(t);var i=a(1),s=a(13),n=a(2),o={name:"HtTemInvoice",componentName:"HtTemInvoice",props:{showSample:Boolean,typeEmun:Object,temData:{type:Object,required:!0},baseFiles:{type:Object,required:!0},invoiceData:{type:Object}},computed:{...Object(i.mapState)(["invoice","templateHeader","templateBody","templateFooter"])},watch:{baseFiles:{immediate:!0,handler(){this.$nextTick(()=>{this.initData()})}},temData(){this.setTemplateData(this.temData)},invoiceData(){this.initInvoiceData(this.invoiceData)}},created(){this.$store=Object(s.b)()},methods:{...Object(i.mapActions)(["initStoreData"]),...Object(i.mapMutations)(["setTemplateData","initInvoiceData"]),initData(){this.initStoreData({typeEmun:this.typeEmun,baseFiles:this.baseFiles,temData:this.temData,showSample:this.showSample,invoiceData:this.invoiceData})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-warp"},[e("div",{class:"ht-invoice-tem-content"},[e(n.e,{attrs:{showSample:this.showSample,typeEmun:this.typeEmun,header:this.headerData}}),e(n.g,{attrs:{showSample:this.showSample,header:this.headerData,templateData:this.templateHeader}}),e(n.f,{attrs:{showSample:this.showSample,data:this.bodyData,templateData:this.templateBody}}),e(n.g,{attrs:{showSample:this.showSample,header:this.headerData,templateData:this.templateFooter}}),e(n.d)])])}},r=a(0),l=Object(r.a)(o,void 0,void 0,!1,null,null,null);l.options.__file="packages/custom-invoice/src/tem-invoice.vue";var c=l.exports;c.install=function(e){e.component(c.name,c)};t.default=c}]).default}));
//# sourceMappingURL=index.js.map