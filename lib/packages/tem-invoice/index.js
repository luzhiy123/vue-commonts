!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("hztl-ui/lib/utils/date-util"),require("hztl-ui/lib/packages/resize-box"),require("hztl-ui/lib/utils/priceUppercase")):"function"==typeof define&&define.amd?define("tem-invoice",["hztl-ui/lib/utils/date-util","hztl-ui/lib/packages/resize-box","hztl-ui/lib/utils/priceUppercase"],t):"object"==typeof exports?exports["tem-invoice"]=t(require("hztl-ui/lib/utils/date-util"),require("hztl-ui/lib/packages/resize-box"),require("hztl-ui/lib/utils/priceUppercase")):e["tem-invoice"]=t(e["hztl-ui/lib/utils/date-util"],e["hztl-ui/lib/packages/resize-box"],e["hztl-ui/lib/utils/priceUppercase"])}(window,(function(e,t,a){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=29)}([function(e,t,a){"use strict";function i(e,t,a,i,s,o,n,r){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),i&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),n?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=l):s&&(l=r?function(){s.call(this,this.$root.$options.shadowRoot)}:s),l)if(c.functional){c._injectStyles=l;var p=c.render;c.render=function(e,t){return l.call(t),p(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}a.d(t,"a",(function(){return i}))},function(e,t){e.exports=require("vuex")},function(e,t,a){"use strict";var i=a(6),s=a(1),o={props:{showSample:Boolean},data:()=>({curDate:new Date}),computed:{...Object(s.mapState)(["invoice","typeEmun"]),...Object(s.mapGetters)(["headerData"])},render(){const e=arguments[0];return e("div",{class:"ht-invoice-page-header"},[this.showSample?e("div",{class:"company-logo ht-invoice-sample-class"},["[公司徽章]"]):e("img",{class:"company-logo",attrs:{src:this.headerData.companyEmblem,alt:""}}),e("span",{class:"page-header-tip"},[e("span",{class:"title"},["打印时间："]),e("span",{class:`${this.showSample?"ht-invoice-sample-class":""}`},[Object(i.dateFormatFull)(this.curDate),"（",this.headerData.printCount,")"])]),e("div",{class:`page-header-title ${this.showSample?"ht-invoice-sample-class":""}`},[this.headerData.companyName,this.typeEmun[this.invoice.type]])])}},n=a(0),r=Object(n.a)(o,void 0,void 0,!1,null,null,null);r.options.__file="packages/custom-invoice/src/components/invoice-page-header.vue";var l=r.exports,c=a(7),p={render(){const e=arguments[0];return e("div",{class:"ht-invoice-page-footer"},[e("div",{class:"print-copy-right"},[c.b])])}},u=Object(n.a)(p,void 0,void 0,!1,null,null,null);u.options.__file="packages/custom-invoice/src/components/invoice-page-footer.vue";var d=u.exports,m=a(3),h=a.n(m),f=a(8),v=a.n(f),b={components:{Draggable:v.a},props:{list:{type:Array,required:!0}},methods:{changeHandle(){this.$emit("change",this.list)}},render(){const e=arguments[0];return e("div",{class:"ht-alternative-files"},[e(v.a,h()([{class:"ht-invoice-draggable-group"},{attrs:this.$attrs},{on:{change:()=>this.changeHandle()},attrs:{list:this.list}}]),[this.$scopedSlots.default?this.$scopedSlots.default(this.list):this.list.map(t=>e("div",{class:"list-group-item"},[e("div",{class:"file-item file-name text-ellipsis"},[t.name,"："]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis"},["[",t.sampleData||t.name,"]"])]))])])}},y=Object(n.a)(b,void 0,void 0,!1,null,null,null);y.options.__file="packages/custom-invoice/src/components/alternative-files.vue";var g=y.exports,D={props:{templateData:{type:Array,required:!0}},data:()=>({useTemplateData:[]}),computed:{...Object(s.mapGetters)(["headerData"])},watch:{templateData:{immediate:!0,handler(e){this.useTemplateData=e}}},methods:{handleTemplateChange(e){this.$emit("change",e)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-header"},[e(g,h()([{},{on:this.$listeners},{},{attrs:this.$attrs},{attrs:{group:"header",list:this.useTemplateData},scopedSlots:{default:t=>t.length?t.map(t=>e("div",{class:`list-group-item item-flex-${t.width}`},[e("div",{class:"file-item file-name text-ellipsis"},[t.name,"："]),e("div",{class:`file-item ${"signature"===t.type?"signature-file":""} ht-invoice-sample-class text-ellipsis`},["signature"===t.type?"":`[${this.headerData[t.file]}]`])])):e("div",{class:"no-data"},["拖拽页头页尾部字段设置"])}}]))])}},S=Object(n.a)(D,void 0,void 0,!1,null,null,null);S.options.__file="packages/custom-invoice/src/components/invoice-edit-header.vue";var w=S.exports,x=a(4),_=a.n(x),F=a(12),j=a.n(F),B={props:{soureFile:{type:String,required:!0},templateData:{type:Array,required:!0}},data(){return{debounceHandleTemplateChange:_()(100,this.handleTemplateChange),useTemplateData:[]}},computed:{...Object(s.mapGetters)(["bodysData"]),detail(){return this.bodysData[this.soureFile][0]?this.bodysData[this.soureFile][0]:{}}},watch:{templateData:{immediate:!0,handler(e){this.useTemplateData=e}}},methods:{handleTemplateChange(e){this.$emit("change",e)},handleChangeWidth(e,t){t.width=e,this.debounceHandleTemplateChange(this.templateData)}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-edit-body"},[e(g,h()([{attrs:{group:`body${this.soureFile}`,handle:".dragghandle",list:this.useTemplateData}},{on:this.$listeners},{},{attrs:this.$attrs},{scopedSlots:{default:t=>t.length?t.map(t=>e(j.a,{attrs:{width:t.width},on:{"change-width":e=>this.handleChangeWidth(e,t)},class:"list-group-item",style:{width:`${t.width}px`}},[e("div",{class:"dragghandle"},[e("div",{class:"file-item file-name text-ellipsis",attrs:{title:t.name}},[t.name]),e("div",{class:"file-item ht-invoice-sample-class text-ellipsis",attrs:{title:this.detail[t.file]}},["[",this.detail[t.file],"]"])])])):e("div",{class:"no-data"},["拖拽标题列数据设置表格"])}}]))])}},O=Object(n.a)(B,void 0,void 0,!1,null,null,null);O.options.__file="packages/custom-invoice/src/components/invoice-edit-body.vue";var $=O.exports,T=a(13),H=a.n(T),k={props:{showSample:Boolean,templateData:{type:Array,required:!0}},computed:{...Object(s.mapGetters)(["headerData"]),formatTemplateData(){return this.templateData.map(e=>{const t={...e};if(this.showSample)"signature"===t.type?t.formatter=()=>"":t.formatter=e=>`[${e}]`;else switch(t.type){case"date":t.formatter=i.dateFormat;break;case"uppercase":t.formatter=H.a;break;case"areaNames":t.formatter=e=>e.join("");break;case"signature":t.formatter=()=>"";break;default:t.formatter=e=>e}return t})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-header"},[e("div",{class:"ht-invoice-draggable-group"},[this.formatTemplateData.map(t=>e("div",{class:`list-group-item item-flex-${t.width}`},[e("div",{class:"file-item file-name"},[t.name,"："]),e("div",{class:`file-item ${this.showSample?"ht-invoice-sample-class":""} ${"signature"===t.type?"signature-file":""} text-ellipsis`},[t.formatter(this.headerData[t.file])])]))])])}},q=Object(n.a)(k,void 0,void 0,!1,null,null,null);q.options.__file="packages/custom-invoice/src/components/invoice-tem-header.vue";var E=q.exports,z={props:{showSample:Boolean,templateData:{type:Array,required:!0},data:{type:Array,required:!0}},computed:{columns(){return this.templateData.map(e=>{let t;if(this.showSample)t=e=>`[${e}]`;else switch(e.type){case"index":t=(e,t,a)=>a+1;break;case"date":t=(e,t,a)=>a}return{...e,formatter:t}})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-body"},[e("el-table",{attrs:{data:this.data,border:!0,"row-class-name":this.showSample?"ht-invoice-sample-class":"","tooltip-effect":"dark",size:"mini"}},[this.columns.map(t=>e("el-table-column",{key:t.key||t.prop,attrs:{label:t.name,prop:t.file,width:t.width,align:t.align,"show-overflow-tooltip":!0},scopedSlots:{default:({row:e,$index:a})=>t.formatter?t.formatter(e[t.file],e,a):e[t.file]}}))])])}},C=Object(n.a)(z,void 0,void 0,!1,null,null,null);C.options.__file="packages/custom-invoice/src/components/invoice-tem-body.vue";var N=C.exports;a.d(t,"a",(function(){return g})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return w})),a.d(t,"b",(function(){return $})),a.d(t,"g",(function(){return E})),a.d(t,"f",(function(){return N}))},function(e,t){e.exports=require("@vue/babel-helper-vue-jsx-merge-props")},function(e,t){e.exports=require("throttle-debounce/debounce")},function(e,t){e.exports=require("vue")},function(t,a){t.exports=e},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));const i="思锐软件 （010）60219478/60219479",s={1:"一",2:"二",3:"三"}},function(e,t){e.exports=require("vuedraggable")},,,,function(e,a){e.exports=t},function(e,t){e.exports=a},function(e,t,a){"use strict";var i=a(5),s=a.n(i),o=a(1),n=a.n(o);const r={showSample:!0,typeEmun:{},invoice:{name:"",type:"",id:""},baseHeaders:[],baseBodys:[],temDataSource:{templateHeader:[],templateBody:[],templateFooter:[]},dataSource:{}};const l={async initStoreData({commit:e},t){const{typeEmun:a,baseFiles:i,temData:s,showSample:o,invoiceData:n}=t;await e("setShowSample",o),await e("setTypeEmun",a),await e("setBaseFiles",i),await e("setTemDataSource",s),await e("setDataSource",n)}},c={templateHeader:e=>e.temDataSource.templateHeader.map(t=>e.baseHeaders.find(e=>e.name===t.name)||null).filter(e=>e),templateFooter:e=>e.temDataSource.templateFooter.map(t=>e.baseHeaders.find(e=>e.name===t.name)||null).filter(e=>e),templateBody:e=>e.temDataSource.templateBody.map(t=>({...t,content:t.content.map(a=>{let i;return e.baseBodys.forEach(e=>{i||e.soureFile===t.soureFile&&e.content.forEach(e=>{e.name===a.name&&(i=e)})}),i?{...i,width:a.width||100}:null}).filter(e=>e)})),altHeaderFiles:(e,t)=>e.baseHeaders.filter(e=>![...t.templateHeader,...t.templateFooter].find(t=>t.name===e.name)),altBodyFiles:(e,t)=>e.baseBodys.map(e=>({...e,content:e.content.filter(a=>{const i=t.templateBody.find(t=>t.soureFile===e.soureFile);return i&&!i.content.find(e=>e.name===a.name)})})),headerData(e){if(e.showSample){const t={printCount:0,companyName:"[公司名称]"};return e.baseHeaders.forEach(e=>{t[e.file]=e.sampleData||e.name}),t}return e.dataSource.header},bodysData(e){if(e.showSample){let t={};return e.baseBodys.forEach(e=>{t[e.soureFile]=[{}],e.content.forEach(a=>{t[e.soureFile][0][a.file]=a.sampleData||a.name})}),t}return e.dataSource}},p={setTypeEmun(e,t){e.typeEmun=t},setBaseFiles(e,t){if(t&&t.baseHeaders&&t.baseBodys){e.baseHeaders=t.baseHeaders.map(e=>({...e,width:e.width||1}));const a=t.baseBodys&&t.baseBodys[0];a&&a.soureFile?e.baseBodys=t.baseBodys:e.baseBodys=[{tableName:"",soureFile:"details",content:t.baseBodys||[]}]}else console.error("baseFiles 参数缺失",t),e.baseHeaders=[],e.baseBodys=[{tableName:"",soureFile:"details",content:[]}]},setTemDataSource(e,t){e.invoice={name:t.name,type:t.type,id:t.id};const a=t.content?JSON.parse(t.content):{},i=a.templateBody&&a.templateBody[0];e.temDataSource={templateHeader:[],templateFooter:[],...a,templateBody:i&&i.soureFile?a.templateBody:e.baseBodys.map(e=>({...e,content:a.templateBody||[]}))}},setShowSample(e,t=!0){e.showSample=t},setDataSource(e,t){e.dataSource=t||{}}},u={...p,changeInvoiceName(e,t){e.invoice.name=t},changeTemplateHeader(e,t){e.temDataSource={...e.temDataSource,templateHeader:t}},changeTemplateBody(e,t){e.temDataSource.templateBody=t},changeTemplateFooter(e,t){e.temDataSource.templateFooter=t}},d={...p},m={state:function(){return{type:"edit",...r}},actions:l,getters:c,mutations:u},h={state:function(){return{type:"tem",...r}},actions:l,getters:c,mutations:d};function f(){return new n.a.Store({...m})}function v(){return new n.a.Store({...h})}a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return v})),s.a.use(n.a)},,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t);var i=a(1),s=a(7),o=a(14),n=a(2),r={name:"HtTemInvoice",componentName:"HtTemInvoice",props:{showSample:Boolean,typeEmun:Object,temData:{type:Object,required:!0},baseFiles:{type:Object,required:!0},invoiceData:{type:Object}},computed:{...Object(i.mapState)(["invoice"]),...Object(i.mapGetters)(["templateHeader","templateBody","templateFooter","bodysData"])},watch:{baseFiles:{immediate:!0,handler(){this.$nextTick(()=>{this.initData()})}},temData(){this.setTemDataSource(this.temData)},invoiceData(){this.setDataSource(this.invoiceData)}},created(){this.$store=Object(o.b)()},methods:{...Object(i.mapActions)(["initStoreData"]),...Object(i.mapMutations)(["setTemDataSource","setDataSource"]),initData(){this.initStoreData({typeEmun:this.typeEmun,baseFiles:this.baseFiles,temData:this.temData,showSample:this.showSample,invoiceData:this.invoiceData})}},render(){const e=arguments[0];return e("div",{class:"ht-invoice-tem-warp"},[e("div",{class:"ht-invoice-tem-content"},[e(n.e,{attrs:{showSample:this.showSample}}),e(n.g,{attrs:{showSample:this.showSample,templateData:this.templateHeader}}),e("div",{class:"ht-invoice-body-box"},[this.templateBody.map((t,a)=>this.bodysData[t.soureFile]&&e("div",{class:"ht-invoice-body-block"},[t.tableName&&e("div",{class:"ht-invoice-table-name"},[`${s.a[a+1]}、${t.tableName}`]),e(n.f,{attrs:{showSample:this.showSample,data:this.bodysData[t.soureFile],templateData:t.content}})]))]),e(n.g,{attrs:{showSample:this.showSample,templateData:this.templateFooter}}),e(n.d)])])}},l=a(0),c=Object(l.a)(r,void 0,void 0,!1,null,null,null);c.options.__file="packages/custom-invoice/src/tem-invoice.vue";var p=c.exports;p.install=function(e){e.component(p.name,p)};t.default=p}]).default}));
//# sourceMappingURL=index.js.map